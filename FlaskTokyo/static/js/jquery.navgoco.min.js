(function (e) { "use strict"; var t = function (t, n, r) { this.el = t; this.$el = e(t); this.options = n; this.uuid = this.$el.attr("id") ? this.$el.attr("id") : r; this.state = {}; this.init(); return this }; t.prototype = { init: function () { var t = this; t._load(); t.$el.find("ul").each(function (n) { var r = e(this); r.attr("data-index", n); if (t.options.save && t.state.hasOwnProperty(n)) { r.parent().addClass(t.options.openClass); r.show() } else if (r.parent().hasClass(t.options.openClass)) { r.show(); t.state[n] = 1 } else { r.hide() } }); if (t.options.caret) { t.$el.find("li:has(ul) > a").append(t.options.caret) } var n = t.$el.find("li > a"); n.on("click", function (n) { n.stopPropagation(); var r = e(this).next(); r = r.length > 0 ? r : false; t.options.onClickBefore.call(this, n, r); if (r) { n.preventDefault(); t._toggle(r, r.is(":hidden")); t._save() } else { if (t.options.accordion) { var i = t.state = t._parents(e(this)); t.$el.find("ul").filter(":visible").each(function () { var n = e(this), r = n.attr("data-index"); if (!i.hasOwnProperty(r)) { t._toggle(n, false) } }); t._save() } } t.options.onClickAfter.call(this, n, r) }) }, _toggle: function (t, n) { var r = this, i = t.attr("data-index"), s = t.parent(); r.options.onToggleBefore.call(this, t, n); if (n) { s.addClass(r.options.openClass); t.slideDown(r.options.slide); r.state[i] = 1; if (r.options.accordion) { var o = r.state = r._parents(t); o[i] = r.state[i] = 1; r.$el.find("ul").filter(":visible").each(function () { var t = e(this), n = t.attr("data-index"); if (!o.hasOwnProperty(n)) { r._toggle(t, false) } }) } } else { s.removeClass(r.options.openClass); t.slideUp(r.options.slide); r.state[i] = 0 } r.options.onToggleAfter.call(this, t, n) }, _parents: function (t, n) { var r = {}, i = t.parent(), s = i.parents("ul"); s.each(function () { var t = e(this), i = t.attr("data-index"); if (!i) { return false } r[i] = n ? t : 1 }); return r }, _save: function () { if (this.options.save) { var t = {}; for (var r in this.state) { if (this.state[r] === 1) { t[r] = 1 } } n[this.uuid] = this.state = t; e.cookie(this.options.cookie.name, JSON.stringify(n), this.options.cookie) } }, _load: function () { if (this.options.save) { if (n === null) { var t = e.cookie(this.options.cookie.name); n = t ? JSON.parse(t) : {} } this.state = n.hasOwnProperty(this.uuid) ? n[this.uuid] : {} } }, toggle: function (t) { var n = this, r = arguments.length; if (r <= 1) { n.$el.find("ul").each(function () { var r = e(this); n._toggle(r, t) }) } else { var i, s = {}, o = Array.prototype.slice.call(arguments, 1); r--; for (var u = 0; u < r; u++) { i = o[u]; var a = n.$el.find('ul[data-index="' + i + '"]').first(); if (a) { s[i] = a; if (t) { var f = n._parents(a, true); for (var l in f) { if (!s.hasOwnProperty(l)) { s[l] = f[l] } } } } } for (i in s) { n._toggle(s[i], t) } } n._save() }, destroy: function () { e.removeData(this.$el); this.$el.find("li:has(ul) > a").unbind("click") } }; e.fn.navgoco = function (n) { if (typeof n === "string" && n.charAt(0) !== "_" && n !== "init") { var r = true, i = Array.prototype.slice.call(arguments, 1) } else { n = e.extend({}, e.fn.navgoco.defaults, n || {}); if (!e.cookie) { n.save = false } } return this.each(function (s) { var o = e(this), u = o.data("navgoco"); if (!u) { u = new t(this, r ? e.fn.navgoco.defaults : n, s); o.data("navgoco", u) } if (r) { u[n].apply(u, i) } }) }; var n = null; e.fn.navgoco.defaults = { caret: '<span class="caret"></span>', accordion: false, openClass: "open", save: true, cookie: { name: "navgoco", expires: false, path: "/" }, slide: { duration: 400, easing: "swing" }, onClickBefore: e.noop, onClickAfter: e.noop, onToggleBefore: e.noop, onToggleAfter: e.noop } })(jQuery)